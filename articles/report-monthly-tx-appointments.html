<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Report: Treatment appointments â€¢ nhstt</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="report-monthly-tx-appointments_files/libs/quarto-html/popper.min.js"></script><script src="report-monthly-tx-appointments_files/libs/quarto-html/tippy.umd.min.js"></script><link href="report-monthly-tx-appointments_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="report-monthly-tx-appointments_files/libs/quarto-html/light-border.css" rel="stylesheet">
<script type="module" src="report-monthly-tx-appointments_files/libs/quarto-ojs/quarto-ojs-runtime.js"></script><link href="report-monthly-tx-appointments_files/libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script type="ojs-define">
  {"contents":[{"name":"org_list_ojs","value":{"org_code2":["8EJ83","8EJ83","8HX13","8J724","8J766","8JJ53","8JX60","8KJ43","AJA","AKR01","AKR01","ALR01","ALR02","AM601","AM601","AM7","AMC01","AMC03","AMC03","AMC04","AMC04","AMC05","AME01","AMJ","AML01","ANV01","ARY01","C1Y8W","C2J4D","DA1","DA201","DA201","DA6","DAX02","DH0","DH0","DH8","DHA","DRL","DV7","DWY","E0W9O","G6V2S","G7X5M","GDA01","H7L3O","K7Y6R","M4P2I","M6Y4Z","NCH","NCM","NDC05","NDC07","NDC10","NDC16","NDC17","NDC17","NGR01","NI382","NIW","NJG","NKI","NKT","NLS","NMG","NMQ","NNE","NNF","NO202","NO204","NO204","NO401","NQL","NQV","NR5","NWC05","NWC07","NWC08","NWC10","NWC11","NWC12","P6W4I","R0B","R1A","R1C","R1F","R1L","RAT","RDR","RDY","RDYDL","RDYLK","RH5","RJ8","RKE","RKL07","RKL07","RKL14","RKL14","RKL42","RKL42","RMY","RNUDT","RNUDT","RNUDV","RNUDV","RP1","RP7","RPG","RQX","RQY12","RQY58","RQYMI","RQYPR","RRE","RRE","RRF","RRPJ3","RRPJ3","RRPJ4","RRPJ4","RT119","RT1AB","RT2","RTF61","RTQ","RV383","RV3AR","RV3CH","RV3DG","RV3HC","RV3L8","RV5CG","RV5CH","RV5CJ","RV5CK","RV9","RVN","RW1","RW1","RW4","RW501","RW5ME","RWK4D","RWK4D","RWK53","RWK53","RWK79","RWK79","RWRD7","RWRG3","RWV","RWX","RX2","RX301","RX34F","RX3YE","RX40C","RX4K3","RXA29","RXA52","RXE","RXG10","RXG82","RXL","RXM","RXT","RXV","RXX1Y","RY6","RYG","RYK","S5F7C","T6G0K","TAD","TAF87","TAF88","TAF90","TAF90","TAH","TAJ","TAJ86","W5N3Z","Z2E3K","all"],"org_name2":["Peace Hospice","Rennie Grove Peace Hospice Care (Peace Hospice - HQ)","African and Caribbean Mental Health Services","LGBT Foundation","North Kent Mind","Tameside, Oldham and Glossop Mind","Mind in Enfield","Pure Innovations Limited","Dover Counselling Centre HQ","Blackburn Centre","Lancashire Women (ELTT)","Living Well Consortium (Herbert Road)","BMHC-FTB","Ieso Digital Health","Ieso Digital Health (UK)","Sign Health (HQ)","Self Help Services (HQ)","Self Help Services (Eastern Cheshire)","NHS East Cheshire Talking Therapies","Thinking Ahead","NHS Heywood, Middleton and Rochdale Talking Therapies","Self Help Services (Manchester)","Mind in Bexley (HQ)","Lea Vale Medical Group (HQ)","1point (North West)","Centre for Psychology","The Village Practice (Thornton)","Nottinghamshire IAPT Contract Expansion Service","Vita Health Group: Newcastle IAPT","Freeflow Counselling Service","Survivors Manchester (Salford)","We are Survivors (Salford)","Beacon Counselling","Mind in Mid Herts - Hatfield Road","City and Hackney Mind","Mind in the City, Hackney and Waltham Forest","Derman","Bikur Cholim LTD","42nd Street","Off the Record Youth Counselling","Community Barnet","NHS Kent and Medway Talking Therapies: Vita Health Group and We are with you","North London NHS Foundation Trust","We are with you in Surrey","Mind in Barnet (North Finchley)","Gaddum Centre","Family Refugee Support Project","Kingston Talking Therapies","Vita Health Group: Derby and Derbyshire Talking Therapies","Talkplus","Six Degrees Social Enterprise CIC","Everyturn Services LTD Talking Therapies (Peterborough)","Everyturn Services LTD Talking Therapies (Kent & Medway)","Everyturn Services LTD - Derbyshire","Medway Talking Therapies","Talking Together Wirral","NHS Wirral Talking Therapies","The Counselling Foundation HQ","We are with you","Faversham Counselling Service LTD","Alliance Psychology Services LTD","Turning Point","University Medical Centre","Trent PTS","Connect Health Limited","Making Space","Dorking Healthcare Limited (Dhc)","City Health Care Partnership CIC","Warrington Psychological Service","Talking Matters Northumberland","NHS Northumberland Talking Therapies","Herts Mind Network (Hemel Hempstead)","Navigo Health and Social Care CIC","Bromley Healthcare","Livewell Southwest","Vita Health Group: Vita Minds Basildon & Brentwood","Vita Health Group: VitaMinds Bristol, North Somerset & South Gloucestershire","Vita Health Group: VitaMinds West Essex","Vita Health Group: VitaMinds Kent and Medway","Vita Health Group: VitaMinds Derby","Vita Health Group: VitaMinds Calderdale","VitaMinds: LLR","South Tyneside and Sunderland NHS Foundation Trust","Herefordshire and Worcestershire Health and Care NHS Trust","Solent NHS Trust","Isle of Wight NHS Trust","Essex Partnership University NHS Foundation Trust","North East London NHS Foundation Trust","Sussex Community NHS Foundation Trust","Dorset Healthcare University NHS Foundation Trust","Psychological Therapies Southhampton Office","Bournemouth and Poole Primary Care Medical Team","Somerset NHS Foundation Trust","Cornwall Partnership NHS Foundation Trust","Whittington Health NHS Trust","Ealing IAPT","Ealing Talking Therapies","Lakeside Unit","Hammersmith & Fulham Talking Therapies","Gloucester House","Hounslow Talking Therapies","Norfolk and Suffolk NHS Foundation Trust","TalkingSpace Plus","NHS Oxfordshire Talking Therapies","Healthy Minds","NHS Buckinghamshire Talking Therapies","Northamptonshire Healthcare NHS Foundation Trust","Lincolnshire Partnership NHS Foundation Trust","Oxleas NHS Foundation Trust","Homerton Healthcare NHS Foundation Trust","Wandsworth IAPT","St John's Health Centre","Merton IAPT","Sutton IAPT","Midlands Partnership NHS Foundation Trust","Midlands Partnership University NHS Foundation Trust","Wrightington, Wigan and Leigh NHS Foundation Trust","Barnet IAPT","NHS Barnet Talking Therapies","Enfield IAPT","NHS Enfield Talking Therapies","Cambridgeshire and Peterborough Mental Health Partnership Tr HQ","Cambridge and Peterborough Voluntary Organisations","Pennine Care NHS Foundation Trust","Wallsend Health Centre","Gloucestershire Health and Care NHS Foundation Trust","Northwick Park Hospital","Mill House","ICCS","Westminster Wellbeing Service","IAPT Services","Take Time to Talk","Southwark Psychological Therapies Services (Southwark IAPT)","Lewisham Psychological Therapies Service (Lewisham IAPT)","Croydon Psychological Therapies Service (Croydon IAPT)","Lambeth Psychological Therapies Service (Lambeth IAPT)","Humber Teaching NHS Foundation Trust","Avon and Wiltshire Mental Health Partnership NHS Trust","Southern Health NHS Foundation Trust","Hampshire and Isle of Wight Healthcare NHS Foundation Trust","Mersey Care NHS Foundation Trust","Lancashire & South Cumbria NHS Foundation Trust HQ","Cameron House","Gilbert Hitchcock House","Bedfordshire Talking Therapies","Johnson Street","Tower Hamlets Talking Therapies","Newham IAPT","Newham Talking Therapies","Waverley Road","Hertfordshire Partnership Foundation Trust (Tekhnicon House)","Devon Partnership NHS Trust","Berkshire Healthcare NHS Foundation Trust","Sussex Partnership NHS Foundation Trust","Tees, Esk, Wear Valley NHS Trust (Durham)","Bootham Park Hospital - Admin","The Briary Unit","First Step IAPT","Grange Park Clinic Monkmouth Hospital Sunderland Locality","Denton House","1829 Building","Rotherham Doncaster and South Humber NHS Foundation Trust","Fieldhead Hospital","Kendray Hospital","Blackpool Teaching Hospitals NHS Foundation Trust","Derbyshire Healthcare NHS Foundation Trust","Birmingham and Solihull Mental Health NHS Foundation Trust","Greater Manchester Mental Health NHS Foundation Trust","Mind Matters Surrey NHS","Leeds Community Healthcare NHS Trust","Coventry and Warwickshire Partnership NHS Trust","Dudley Integrated Health and Care NHS Trust","NHS Talking Therapies Nottinghamshire","Self Help Services (Stockport)","Bradford District Care NHS Foundation Trust","Islington IAPT","Camden IAPT","Kingston Drug & Alcohol Service","Kingston SMS","Sheffield Health & Social Care NHS Foundation Trust","Black Country Healthcare NHS Foundation Trust","Blakenall Village Centre","Talking Matters Sefton","Sunderland Mind","All Providers"],"org_name_code":["Peace Hospice (8EJ83)","Rennie Grove Peace Hospice Care (Peace Hospice - HQ) (8EJ83)","African and Caribbean Mental Health Services (8HX13)","LGBT Foundation (8J724)","North Kent Mind (8J766)","Tameside, Oldham and Glossop Mind (8JJ53)","Mind in Enfield (8JX60)","Pure Innovations Limited (8KJ43)","Dover Counselling Centre HQ (AJA)","Blackburn Centre (AKR01)","Lancashire Women (ELTT) (AKR01)","Living Well Consortium (Herbert Road) (ALR01)","BMHC-FTB (ALR02)","Ieso Digital Health (AM601)","Ieso Digital Health (UK) (AM601)","Sign Health (HQ) (AM7)","Self Help Services (HQ) (AMC01)","Self Help Services (Eastern Cheshire) (AMC03)","NHS East Cheshire Talking Therapies (AMC03)","Thinking Ahead (AMC04)","NHS Heywood, Middleton and Rochdale Talking Therapies (AMC04)","Self Help Services (Manchester) (AMC05)","Mind in Bexley (HQ) (AME01)","Lea Vale Medical Group (HQ) (AMJ)","1point (North West) (AML01)","Centre for Psychology (ANV01)","The Village Practice (Thornton) (ARY01)","Nottinghamshire IAPT Contract Expansion Service (C1Y8W)","Vita Health Group: Newcastle IAPT (C2J4D)","Freeflow Counselling Service (DA1)","Survivors Manchester (Salford) (DA201)","We are Survivors (Salford) (DA201)","Beacon Counselling (DA6)","Mind in Mid Herts - Hatfield Road (DAX02)","City and Hackney Mind (DH0)","Mind in the City, Hackney and Waltham Forest (DH0)","Derman (DH8)","Bikur Cholim LTD (DHA)","42nd Street (DRL)","Off the Record Youth Counselling (DV7)","Community Barnet (DWY)","NHS Kent and Medway Talking Therapies: Vita Health Group and We are with you (E0W9O)","North London NHS Foundation Trust (G6V2S)","We are with you in Surrey (G7X5M)","Mind in Barnet (North Finchley) (GDA01)","Gaddum Centre (H7L3O)","Family Refugee Support Project (K7Y6R)","Kingston Talking Therapies (M4P2I)","Vita Health Group: Derby and Derbyshire Talking Therapies (M6Y4Z)","Talkplus (NCH)","Six Degrees Social Enterprise CIC (NCM)","Everyturn Services LTD Talking Therapies (Peterborough) (NDC05)","Everyturn Services LTD Talking Therapies (Kent & Medway) (NDC07)","Everyturn Services LTD - Derbyshire (NDC10)","Medway Talking Therapies (NDC16)","Talking Together Wirral (NDC17)","NHS Wirral Talking Therapies (NDC17)","The Counselling Foundation HQ (NGR01)","We are with you (NI382)","Faversham Counselling Service LTD (NIW)","Alliance Psychology Services LTD (NJG)","Turning Point (NKI)","University Medical Centre (NKT)","Trent PTS (NLS)","Connect Health Limited (NMG)","Making Space (NMQ)","Dorking Healthcare Limited (Dhc) (NNE)","City Health Care Partnership CIC (NNF)","Warrington Psychological Service (NO202)","Talking Matters Northumberland (NO204)","NHS Northumberland Talking Therapies (NO204)","Herts Mind Network (Hemel Hempstead) (NO401)","Navigo Health and Social Care CIC (NQL)","Bromley Healthcare (NQV)","Livewell Southwest (NR5)","Vita Health Group: Vita Minds Basildon & Brentwood (NWC05)","Vita Health Group: VitaMinds Bristol, North Somerset & South Gloucestershire (NWC07)","Vita Health Group: VitaMinds West Essex (NWC08)","Vita Health Group: VitaMinds Kent and Medway (NWC10)","Vita Health Group: VitaMinds Derby (NWC11)","Vita Health Group: VitaMinds Calderdale (NWC12)","VitaMinds: LLR (P6W4I)","South Tyneside and Sunderland NHS Foundation Trust (R0B)","Herefordshire and Worcestershire Health and Care NHS Trust (R1A)","Solent NHS Trust (R1C)","Isle of Wight NHS Trust (R1F)","Essex Partnership University NHS Foundation Trust (R1L)","North East London NHS Foundation Trust (RAT)","Sussex Community NHS Foundation Trust (RDR)","Dorset Healthcare University NHS Foundation Trust (RDY)","Psychological Therapies Southhampton Office (RDYDL)","Bournemouth and Poole Primary Care Medical Team (RDYLK)","Somerset NHS Foundation Trust (RH5)","Cornwall Partnership NHS Foundation Trust (RJ8)","Whittington Health NHS Trust (RKE)","Ealing IAPT (RKL07)","Ealing Talking Therapies (RKL07)","Lakeside Unit (RKL14)","Hammersmith & Fulham Talking Therapies (RKL14)","Gloucester House (RKL42)","Hounslow Talking Therapies (RKL42)","Norfolk and Suffolk NHS Foundation Trust (RMY)","TalkingSpace Plus (RNUDT)","NHS Oxfordshire Talking Therapies (RNUDT)","Healthy Minds (RNUDV)","NHS Buckinghamshire Talking Therapies (RNUDV)","Northamptonshire Healthcare NHS Foundation Trust (RP1)","Lincolnshire Partnership NHS Foundation Trust (RP7)","Oxleas NHS Foundation Trust (RPG)","Homerton Healthcare NHS Foundation Trust (RQX)","Wandsworth IAPT (RQY12)","St John's Health Centre (RQY58)","Merton IAPT (RQYMI)","Sutton IAPT (RQYPR)","Midlands Partnership NHS Foundation Trust (RRE)","Midlands Partnership University NHS Foundation Trust (RRE)","Wrightington, Wigan and Leigh NHS Foundation Trust (RRF)","Barnet IAPT (RRPJ3)","NHS Barnet Talking Therapies (RRPJ3)","Enfield IAPT (RRPJ4)","NHS Enfield Talking Therapies (RRPJ4)","Cambridgeshire and Peterborough Mental Health Partnership Tr HQ (RT119)","Cambridge and Peterborough Voluntary Organisations (RT1AB)","Pennine Care NHS Foundation Trust (RT2)","Wallsend Health Centre (RTF61)","Gloucestershire Health and Care NHS Foundation Trust (RTQ)","Northwick Park Hospital (RV383)","Mill House (RV3AR)","ICCS (RV3CH)","Westminster Wellbeing Service (RV3DG)","IAPT Services (RV3HC)","Take Time to Talk (RV3L8)","Southwark Psychological Therapies Services (Southwark IAPT) (RV5CG)","Lewisham Psychological Therapies Service (Lewisham IAPT) (RV5CH)","Croydon Psychological Therapies Service (Croydon IAPT) (RV5CJ)","Lambeth Psychological Therapies Service (Lambeth IAPT) (RV5CK)","Humber Teaching NHS Foundation Trust (RV9)","Avon and Wiltshire Mental Health Partnership NHS Trust (RVN)","Southern Health NHS Foundation Trust (RW1)","Hampshire and Isle of Wight Healthcare NHS Foundation Trust (RW1)","Mersey Care NHS Foundation Trust (RW4)","Lancashire & South Cumbria NHS Foundation Trust HQ (RW501)","Cameron House (RW5ME)","Gilbert Hitchcock House (RWK4D)","Bedfordshire Talking Therapies (RWK4D)","Johnson Street (RWK53)","Tower Hamlets Talking Therapies (RWK53)","Newham IAPT (RWK79)","Newham Talking Therapies (RWK79)","Waverley Road (RWRD7)","Hertfordshire Partnership Foundation Trust (Tekhnicon House) (RWRG3)","Devon Partnership NHS Trust (RWV)","Berkshire Healthcare NHS Foundation Trust (RWX)","Sussex Partnership NHS Foundation Trust (RX2)","Tees, Esk, Wear Valley NHS Trust (Durham) (RX301)","Bootham Park Hospital - Admin (RX34F)","The Briary Unit (RX3YE)","First Step IAPT (RX40C)","Grange Park Clinic Monkmouth Hospital Sunderland Locality (RX4K3)","Denton House (RXA29)","1829 Building (RXA52)","Rotherham Doncaster and South Humber NHS Foundation Trust (RXE)","Fieldhead Hospital (RXG10)","Kendray Hospital (RXG82)","Blackpool Teaching Hospitals NHS Foundation Trust (RXL)","Derbyshire Healthcare NHS Foundation Trust (RXM)","Birmingham and Solihull Mental Health NHS Foundation Trust (RXT)","Greater Manchester Mental Health NHS Foundation Trust (RXV)","Mind Matters Surrey NHS (RXX1Y)","Leeds Community Healthcare NHS Trust (RY6)","Coventry and Warwickshire Partnership NHS Trust (RYG)","Dudley Integrated Health and Care NHS Trust (RYK)","NHS Talking Therapies Nottinghamshire (S5F7C)","Self Help Services (Stockport) (T6G0K)","Bradford District Care NHS Foundation Trust (TAD)","Islington IAPT (TAF87)","Camden IAPT (TAF88)","Kingston Drug & Alcohol Service (TAF90)","Kingston SMS (TAF90)","Sheffield Health & Social Care NHS Foundation Trust (TAH)","Black Country Healthcare NHS Foundation Trust (TAJ)","Blakenall Village Centre (TAJ86)","Talking Matters Sefton (W5N3Z)","Sunderland Mind (Z2E3K)","All Providers (all)"]}}]}
  </script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Report: Treatment appointments">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nhstt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Function reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-how-to-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">How-to guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-how-to-guides">
<li><h6 class="dropdown-header" data-toc-skip>Annual data</h6></li>
    <li><a class="dropdown-item" href="../articles/how-to-key-measures-annual.html">Key measures</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Monthly data</h6></li>
    <li><a class="dropdown-item" href="../articles/how-to-activity-performance-monthly.html">Activity and performance</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-metadata" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Metadata</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-metadata">
<li><h6 class="dropdown-header" data-toc-skip>Annual metadata</h6></li>
    <li><a class="dropdown-item" href="../articles/metadata-annual.html">Key measures</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Monthly metadata</h6></li>
    <li><a class="dropdown-item" href="../articles/metadata-monthly-core.html">Core measures</a></li>
    <li><a class="dropdown-item" href="../articles/metadata-monthly-ea.html">Employment Advisor (EA) measures</a></li>
    <li><a class="dropdown-item" href="../articles/metadata-monthly-ltc.html">Long-term Condition (LTC) measures</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reports" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reports</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reports">
<li><h6 class="dropdown-header" data-toc-skip>Drafts</h6></li>
    <li><a class="dropdown-item" href="../articles/report-monthly-tx-appointments.html">Number of treatment appointments</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bennettoxford/nhstt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Report: Treatment appointments</h1>




      <small class="dont-index">Source: <a href="https://github.com/bennettoxford/nhstt/blob/main/vignettes/report-monthly-tx-appointments.qmd" class="external-link"><code>vignettes/report-monthly-tx-appointments.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="level2"><h2 id="select-nhs-talking-therapies-provider">Select NHS Talking Therapies provider<a class="anchor" aria-label="anchor" href="#select-nhs-talking-therapies-provider"></a>
</h2>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="133" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 132;"><span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a><span class="co">// Convert R data to JavaScript array of objects</span></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>organisations <span class="op">=</span> <span class="fu">transpose</span>(org_list_ojs)</span></code></pre></div>
<div id="convert-data" class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="141" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 140;"><span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a><span class="co">// Step 1: Just read URL parameter</span></span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>urlOrgsParam <span class="op">=</span> {</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> params <span class="op">=</span> <span class="kw">new</span> <span class="fu">URLSearchParams</span>(<span class="bu">window</span><span class="op">.</span><span class="at">location</span><span class="op">.</span><span class="at">search</span>)<span class="op">;</span></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> params<span class="op">.</span><span class="fu">get</span>(<span class="st">'orgs'</span>) <span class="op">||</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="url-reader-test" class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="152" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 151;"><span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a><span class="co">// Step 2: Parse URL parameter into array of codes</span></span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>urlOrgCodes <span class="op">=</span> {</span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>urlOrgsParam) <span class="cf">return</span> []<span class="op">;</span></span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> codes <span class="op">=</span> urlOrgsParam<span class="op">.</span><span class="fu">split</span>(<span class="st">','</span>)<span class="op">;</span></span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> trimmed <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> codes<span class="op">.</span><span class="at">length</span> <span class="op">&amp;&amp;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> code <span class="op">=</span> codes[i]<span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (code<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>      trimmed<span class="op">.</span><span class="fu">push</span>(code)<span class="op">;</span></span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> trimmed<span class="op">;</span></span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="parse-url-codes" class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="174" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 173;"><span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a><span class="co">// Step 3: Validate codes and convert to org objects</span></span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a>initialSelectedOrgs <span class="op">=</span> {</span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> resolved <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> urlOrgCodes<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> code <span class="op">=</span> urlOrgCodes[i]<span class="op">;</span></span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Find org with this code</span></span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> found <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> organisations<span class="op">.</span><span class="at">length</span><span class="op">;</span> j<span class="op">++</span>) {</span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (organisations[j]<span class="op">.</span><span class="at">org_code2</span> <span class="op">===</span> code) {</span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a>        found <span class="op">=</span> organisations[j]<span class="op">;</span></span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span><span class="op">;</span></span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Add if valid and not duplicate</span></span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (found) {</span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> isDuplicate <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (<span class="kw">let</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> resolved<span class="op">.</span><span class="at">length</span><span class="op">;</span> k<span class="op">++</span>) {</span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (resolved[k]<span class="op">.</span><span class="at">org_code2</span> <span class="op">===</span> code) {</span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a>          isDuplicate <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a>          <span class="cf">break</span><span class="op">;</span></span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>isDuplicate) {</span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a>        resolved<span class="op">.</span><span class="fu">push</span>(found)<span class="op">;</span></span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-206"><a href="#cb4-206" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> resolved<span class="op">;</span></span>
<span id="cb4-207"><a href="#cb4-207" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="resolve-url-orgs" class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="214" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 213;"><span id="cb5-214"><a href="#cb5-214" aria-hidden="true" tabindex="-1"></a><span class="co">// Professional UI styling</span></span>
<span id="cb5-215"><a href="#cb5-215" aria-hidden="true" tabindex="-1"></a>styles <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;style&gt;</span></span>
<span id="cb5-216"><a href="#cb5-216" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-container {</span></span>
<span id="cb5-217"><a href="#cb5-217" aria-hidden="true" tabindex="-1"></a><span class="vs">    max-width: 800px;</span></span>
<span id="cb5-218"><a href="#cb5-218" aria-hidden="true" tabindex="-1"></a><span class="vs">    margin: 0 auto;</span></span>
<span id="cb5-219"><a href="#cb5-219" aria-hidden="true" tabindex="-1"></a><span class="vs">    padding: 0 4px;</span></span>
<span id="cb5-220"><a href="#cb5-220" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-221"><a href="#cb5-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-222"><a href="#cb5-222" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-input-group {</span></span>
<span id="cb5-223"><a href="#cb5-223" aria-hidden="true" tabindex="-1"></a><span class="vs">    margin-bottom: 20px;</span></span>
<span id="cb5-224"><a href="#cb5-224" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-225"><a href="#cb5-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-226"><a href="#cb5-226" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-label {</span></span>
<span id="cb5-227"><a href="#cb5-227" aria-hidden="true" tabindex="-1"></a><span class="vs">    display: block;</span></span>
<span id="cb5-228"><a href="#cb5-228" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-weight: 600;</span></span>
<span id="cb5-229"><a href="#cb5-229" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-size: 14px;</span></span>
<span id="cb5-230"><a href="#cb5-230" aria-hidden="true" tabindex="-1"></a><span class="vs">    margin-bottom: 6px;</span></span>
<span id="cb5-231"><a href="#cb5-231" aria-hidden="true" tabindex="-1"></a><span class="vs">    color: #212529;</span></span>
<span id="cb5-232"><a href="#cb5-232" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-233"><a href="#cb5-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-234"><a href="#cb5-234" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-input {</span></span>
<span id="cb5-235"><a href="#cb5-235" aria-hidden="true" tabindex="-1"></a><span class="vs">    width: 100%;</span></span>
<span id="cb5-236"><a href="#cb5-236" aria-hidden="true" tabindex="-1"></a><span class="vs">    padding: 10px 12px;</span></span>
<span id="cb5-237"><a href="#cb5-237" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-size: 14px;</span></span>
<span id="cb5-238"><a href="#cb5-238" aria-hidden="true" tabindex="-1"></a><span class="vs">    border: 1px solid #dee2e6;</span></span>
<span id="cb5-239"><a href="#cb5-239" aria-hidden="true" tabindex="-1"></a><span class="vs">    border-radius: 0.375rem;</span></span>
<span id="cb5-240"><a href="#cb5-240" aria-hidden="true" tabindex="-1"></a><span class="vs">    box-sizing: border-box;</span></span>
<span id="cb5-241"><a href="#cb5-241" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-242"><a href="#cb5-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-243"><a href="#cb5-243" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-input:focus {</span></span>
<span id="cb5-244"><a href="#cb5-244" aria-hidden="true" tabindex="-1"></a><span class="vs">    outline: none;</span></span>
<span id="cb5-245"><a href="#cb5-245" aria-hidden="true" tabindex="-1"></a><span class="vs">    border-color: #86b7fe;</span></span>
<span id="cb5-246"><a href="#cb5-246" aria-hidden="true" tabindex="-1"></a><span class="vs">    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);</span></span>
<span id="cb5-247"><a href="#cb5-247" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-248"><a href="#cb5-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-249"><a href="#cb5-249" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-select {</span></span>
<span id="cb5-250"><a href="#cb5-250" aria-hidden="true" tabindex="-1"></a><span class="vs">    width: 100%;</span></span>
<span id="cb5-251"><a href="#cb5-251" aria-hidden="true" tabindex="-1"></a><span class="vs">    padding: 10px 12px;</span></span>
<span id="cb5-252"><a href="#cb5-252" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-size: 14px;</span></span>
<span id="cb5-253"><a href="#cb5-253" aria-hidden="true" tabindex="-1"></a><span class="vs">    border: 1px solid #dee2e6;</span></span>
<span id="cb5-254"><a href="#cb5-254" aria-hidden="true" tabindex="-1"></a><span class="vs">    border-radius: 0.375rem;</span></span>
<span id="cb5-255"><a href="#cb5-255" aria-hidden="true" tabindex="-1"></a><span class="vs">    box-sizing: border-box;</span></span>
<span id="cb5-256"><a href="#cb5-256" aria-hidden="true" tabindex="-1"></a><span class="vs">    background-color: white;</span></span>
<span id="cb5-257"><a href="#cb5-257" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-258"><a href="#cb5-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-259"><a href="#cb5-259" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-select:disabled {</span></span>
<span id="cb5-260"><a href="#cb5-260" aria-hidden="true" tabindex="-1"></a><span class="vs">    background-color: #e9ecef;</span></span>
<span id="cb5-261"><a href="#cb5-261" aria-hidden="true" tabindex="-1"></a><span class="vs">    color: #6c757d;</span></span>
<span id="cb5-262"><a href="#cb5-262" aria-hidden="true" tabindex="-1"></a><span class="vs">    cursor: not-allowed;</span></span>
<span id="cb5-263"><a href="#cb5-263" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-264"><a href="#cb5-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-265"><a href="#cb5-265" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-helper-text {</span></span>
<span id="cb5-266"><a href="#cb5-266" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-size: 12px;</span></span>
<span id="cb5-267"><a href="#cb5-267" aria-hidden="true" tabindex="-1"></a><span class="vs">    color: #6c757d;</span></span>
<span id="cb5-268"><a href="#cb5-268" aria-hidden="true" tabindex="-1"></a><span class="vs">    margin-top: 4px;</span></span>
<span id="cb5-269"><a href="#cb5-269" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-style: italic;</span></span>
<span id="cb5-270"><a href="#cb5-270" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-271"><a href="#cb5-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-272"><a href="#cb5-272" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-result-box {</span></span>
<span id="cb5-273"><a href="#cb5-273" aria-hidden="true" tabindex="-1"></a><span class="vs">    margin-top: 20px;</span></span>
<span id="cb5-274"><a href="#cb5-274" aria-hidden="true" tabindex="-1"></a><span class="vs">    padding: 16px;</span></span>
<span id="cb5-275"><a href="#cb5-275" aria-hidden="true" tabindex="-1"></a><span class="vs">    border: 1px solid #dee2e6;</span></span>
<span id="cb5-276"><a href="#cb5-276" aria-hidden="true" tabindex="-1"></a><span class="vs">    border-radius: 0.375rem;</span></span>
<span id="cb5-277"><a href="#cb5-277" aria-hidden="true" tabindex="-1"></a><span class="vs">    background: white;</span></span>
<span id="cb5-278"><a href="#cb5-278" aria-hidden="true" tabindex="-1"></a><span class="vs">    min-height: 120px;</span></span>
<span id="cb5-279"><a href="#cb5-279" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-280"><a href="#cb5-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-281"><a href="#cb5-281" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-result-title {</span></span>
<span id="cb5-282"><a href="#cb5-282" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-weight: 600;</span></span>
<span id="cb5-283"><a href="#cb5-283" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-size: 14px;</span></span>
<span id="cb5-284"><a href="#cb5-284" aria-hidden="true" tabindex="-1"></a><span class="vs">    margin: 0 0 12px 0;</span></span>
<span id="cb5-285"><a href="#cb5-285" aria-hidden="true" tabindex="-1"></a><span class="vs">    color: #495057;</span></span>
<span id="cb5-286"><a href="#cb5-286" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-287"><a href="#cb5-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-288"><a href="#cb5-288" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-result-content {</span></span>
<span id="cb5-289"><a href="#cb5-289" aria-hidden="true" tabindex="-1"></a><span class="vs">    margin: 0;</span></span>
<span id="cb5-290"><a href="#cb5-290" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-size: 14px;</span></span>
<span id="cb5-291"><a href="#cb5-291" aria-hidden="true" tabindex="-1"></a><span class="vs">    color: #212529;</span></span>
<span id="cb5-292"><a href="#cb5-292" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-293"><a href="#cb5-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-294"><a href="#cb5-294" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-result-empty {</span></span>
<span id="cb5-295"><a href="#cb5-295" aria-hidden="true" tabindex="-1"></a><span class="vs">    margin: 0;</span></span>
<span id="cb5-296"><a href="#cb5-296" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-size: 14px;</span></span>
<span id="cb5-297"><a href="#cb5-297" aria-hidden="true" tabindex="-1"></a><span class="vs">    color: #6c757d;</span></span>
<span id="cb5-298"><a href="#cb5-298" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-299"><a href="#cb5-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-300"><a href="#cb5-300" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-chip-container {</span></span>
<span id="cb5-301"><a href="#cb5-301" aria-hidden="true" tabindex="-1"></a><span class="vs">    display: flex;</span></span>
<span id="cb5-302"><a href="#cb5-302" aria-hidden="true" tabindex="-1"></a><span class="vs">    flex-wrap: wrap;</span></span>
<span id="cb5-303"><a href="#cb5-303" aria-hidden="true" tabindex="-1"></a><span class="vs">    gap: 6px;</span></span>
<span id="cb5-304"><a href="#cb5-304" aria-hidden="true" tabindex="-1"></a><span class="vs">    min-height: 28px;</span></span>
<span id="cb5-305"><a href="#cb5-305" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-306"><a href="#cb5-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-307"><a href="#cb5-307" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-chip {</span></span>
<span id="cb5-308"><a href="#cb5-308" aria-hidden="true" tabindex="-1"></a><span class="vs">    display: inline-flex;</span></span>
<span id="cb5-309"><a href="#cb5-309" aria-hidden="true" tabindex="-1"></a><span class="vs">    align-items: center;</span></span>
<span id="cb5-310"><a href="#cb5-310" aria-hidden="true" tabindex="-1"></a><span class="vs">    gap: 6px;</span></span>
<span id="cb5-311"><a href="#cb5-311" aria-hidden="true" tabindex="-1"></a><span class="vs">    padding: 4px 10px;</span></span>
<span id="cb5-312"><a href="#cb5-312" aria-hidden="true" tabindex="-1"></a><span class="vs">    background: #f8f9fa;</span></span>
<span id="cb5-313"><a href="#cb5-313" aria-hidden="true" tabindex="-1"></a><span class="vs">    border: 1px solid #dee2e6;</span></span>
<span id="cb5-314"><a href="#cb5-314" aria-hidden="true" tabindex="-1"></a><span class="vs">    border-radius: 0.25rem;</span></span>
<span id="cb5-315"><a href="#cb5-315" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-size: 13px;</span></span>
<span id="cb5-316"><a href="#cb5-316" aria-hidden="true" tabindex="-1"></a><span class="vs">    color: #212529;</span></span>
<span id="cb5-317"><a href="#cb5-317" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-318"><a href="#cb5-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-319"><a href="#cb5-319" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-chip-remove {</span></span>
<span id="cb5-320"><a href="#cb5-320" aria-hidden="true" tabindex="-1"></a><span class="vs">    background: none;</span></span>
<span id="cb5-321"><a href="#cb5-321" aria-hidden="true" tabindex="-1"></a><span class="vs">    border: none;</span></span>
<span id="cb5-322"><a href="#cb5-322" aria-hidden="true" tabindex="-1"></a><span class="vs">    color: #adb5bd;</span></span>
<span id="cb5-323"><a href="#cb5-323" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-size: 18px;</span></span>
<span id="cb5-324"><a href="#cb5-324" aria-hidden="true" tabindex="-1"></a><span class="vs">    line-height: 1;</span></span>
<span id="cb5-325"><a href="#cb5-325" aria-hidden="true" tabindex="-1"></a><span class="vs">    cursor: pointer;</span></span>
<span id="cb5-326"><a href="#cb5-326" aria-hidden="true" tabindex="-1"></a><span class="vs">    padding: 0;</span></span>
<span id="cb5-327"><a href="#cb5-327" aria-hidden="true" tabindex="-1"></a><span class="vs">    margin-left: 4px;</span></span>
<span id="cb5-328"><a href="#cb5-328" aria-hidden="true" tabindex="-1"></a><span class="vs">    width: 16px;</span></span>
<span id="cb5-329"><a href="#cb5-329" aria-hidden="true" tabindex="-1"></a><span class="vs">    height: 16px;</span></span>
<span id="cb5-330"><a href="#cb5-330" aria-hidden="true" tabindex="-1"></a><span class="vs">    display: flex;</span></span>
<span id="cb5-331"><a href="#cb5-331" aria-hidden="true" tabindex="-1"></a><span class="vs">    align-items: center;</span></span>
<span id="cb5-332"><a href="#cb5-332" aria-hidden="true" tabindex="-1"></a><span class="vs">    justify-content: center;</span></span>
<span id="cb5-333"><a href="#cb5-333" aria-hidden="true" tabindex="-1"></a><span class="vs">    transition: color 0.15s;</span></span>
<span id="cb5-334"><a href="#cb5-334" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-335"><a href="#cb5-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-336"><a href="#cb5-336" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-chip-remove:hover {</span></span>
<span id="cb5-337"><a href="#cb5-337" aria-hidden="true" tabindex="-1"></a><span class="vs">    color: #6c757d;</span></span>
<span id="cb5-338"><a href="#cb5-338" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-339"><a href="#cb5-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-340"><a href="#cb5-340" aria-hidden="true" tabindex="-1"></a><span class="vs">  .nhstt-selection-info {</span></span>
<span id="cb5-341"><a href="#cb5-341" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-size: 12px;</span></span>
<span id="cb5-342"><a href="#cb5-342" aria-hidden="true" tabindex="-1"></a><span class="vs">    color: #6c757d;</span></span>
<span id="cb5-343"><a href="#cb5-343" aria-hidden="true" tabindex="-1"></a><span class="vs">    margin-top: 8px;</span></span>
<span id="cb5-344"><a href="#cb5-344" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-weight: 600;</span></span>
<span id="cb5-345"><a href="#cb5-345" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb5-346"><a href="#cb5-346" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;`</span></span></code></pre></div>
<div id="ui-styles" class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="353" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 352;"><span id="cb6-353"><a href="#cb6-353" aria-hidden="true" tabindex="-1"></a>viewof searchQuery <span class="op">=</span> {</span>
<span id="cb6-354"><a href="#cb6-354" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> container <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="nhstt-container"&gt;</span></span>
<span id="cb6-355"><a href="#cb6-355" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div class="nhstt-input-group"&gt;</span></span>
<span id="cb6-356"><a href="#cb6-356" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;label class="nhstt-label"&gt;Search NHS Talking Therapies provider&lt;/label&gt;</span></span>
<span id="cb6-357"><a href="#cb6-357" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;input</span></span>
<span id="cb6-358"><a href="#cb6-358" aria-hidden="true" tabindex="-1"></a><span class="vs">        type="text"</span></span>
<span id="cb6-359"><a href="#cb6-359" aria-hidden="true" tabindex="-1"></a><span class="vs">        class="nhstt-input"</span></span>
<span id="cb6-360"><a href="#cb6-360" aria-hidden="true" tabindex="-1"></a><span class="vs">        placeholder="Enter at least 3 characters to search..."</span></span>
<span id="cb6-361"><a href="#cb6-361" aria-hidden="true" tabindex="-1"></a><span class="vs">        value=""</span></span>
<span id="cb6-362"><a href="#cb6-362" aria-hidden="true" tabindex="-1"></a><span class="vs">      /&gt;</span></span>
<span id="cb6-363"><a href="#cb6-363" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;div class="nhstt-helper-text"&gt;Search by organisation name or code&lt;/div&gt;</span></span>
<span id="cb6-364"><a href="#cb6-364" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/div&gt;</span></span>
<span id="cb6-365"><a href="#cb6-365" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb6-366"><a href="#cb6-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-367"><a href="#cb6-367" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> input <span class="op">=</span> container<span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'input'</span>)<span class="op">;</span></span>
<span id="cb6-368"><a href="#cb6-368" aria-hidden="true" tabindex="-1"></a>  container<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb6-369"><a href="#cb6-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-370"><a href="#cb6-370" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">'input'</span><span class="op">,</span> (e) <span class="kw">=&gt;</span> {</span>
<span id="cb6-371"><a href="#cb6-371" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="at">value</span> <span class="op">=</span> e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb6-372"><a href="#cb6-372" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(<span class="st">'input'</span>))<span class="op">;</span></span>
<span id="cb6-373"><a href="#cb6-373" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb6-374"><a href="#cb6-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-375"><a href="#cb6-375" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> container<span class="op">;</span></span>
<span id="cb6-376"><a href="#cb6-376" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="search-input" class="cell-output cell-output-display">
<div id="ojs-cell-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="383" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 382;"><span id="cb7-383"><a href="#cb7-383" aria-hidden="true" tabindex="-1"></a><span class="co">// Filter organisations based on search query</span></span>
<span id="cb7-384"><a href="#cb7-384" aria-hidden="true" tabindex="-1"></a>filteredOrganisations <span class="op">=</span> {</span>
<span id="cb7-385"><a href="#cb7-385" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>searchQuery <span class="op">||</span> searchQuery<span class="op">.</span><span class="at">length</span> <span class="op">&lt;</span> <span class="dv">3</span>) {</span>
<span id="cb7-386"><a href="#cb7-386" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> []<span class="op">;</span></span>
<span id="cb7-387"><a href="#cb7-387" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-388"><a href="#cb7-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-389"><a href="#cb7-389" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> lowerQuery <span class="op">=</span> searchQuery<span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">;</span></span>
<span id="cb7-390"><a href="#cb7-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-391"><a href="#cb7-391" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> organisations<span class="op">.</span><span class="fu">filter</span>(org <span class="kw">=&gt;</span> {</span>
<span id="cb7-392"><a href="#cb7-392" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> nameCodeMatch <span class="op">=</span> org<span class="op">.</span><span class="at">org_name_code</span><span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">.</span><span class="fu">includes</span>(lowerQuery)<span class="op">;</span></span>
<span id="cb7-393"><a href="#cb7-393" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nameCodeMatch<span class="op">;</span></span>
<span id="cb7-394"><a href="#cb7-394" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb7-395"><a href="#cb7-395" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="filter-organisations" class="cell-output cell-output-display">
<div id="ojs-cell-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="402" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 401;"><span id="cb8-402"><a href="#cb8-402" aria-hidden="true" tabindex="-1"></a><span class="co">// Mutable state for selected organisations (max 3)</span></span>
<span id="cb8-403"><a href="#cb8-403" aria-hidden="true" tabindex="-1"></a><span class="co">// Step 4: Initialize from URL</span></span>
<span id="cb8-404"><a href="#cb8-404" aria-hidden="true" tabindex="-1"></a>mutable selectedOrgs <span class="op">=</span> initialSelectedOrgs</span></code></pre></div>
<div id="selected-organisations-state" class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="411" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 410;"><span id="cb9-411"><a href="#cb9-411" aria-hidden="true" tabindex="-1"></a>viewof orgToAdd <span class="op">=</span> {</span>
<span id="cb9-412"><a href="#cb9-412" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> hasResults <span class="op">=</span> filteredOrganisations<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-413"><a href="#cb9-413" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> showPlaceholder <span class="op">=</span> <span class="op">!</span>searchQuery <span class="op">||</span> searchQuery<span class="op">.</span><span class="at">length</span> <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb9-414"><a href="#cb9-414" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> maxReached <span class="op">=</span> selectedOrgs<span class="op">.</span><span class="at">length</span> <span class="op">&gt;=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb9-415"><a href="#cb9-415" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> isDisabled <span class="op">=</span> <span class="op">!</span>hasResults <span class="op">||</span> maxReached<span class="op">;</span></span>
<span id="cb9-416"><a href="#cb9-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-417"><a href="#cb9-417" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> container <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="nhstt-container"&gt;</span></span>
<span id="cb9-418"><a href="#cb9-418" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div class="nhstt-input-group"&gt;</span></span>
<span id="cb9-419"><a href="#cb9-419" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;label class="nhstt-label"&gt;</span></span>
<span id="cb9-420"><a href="#cb9-420" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">${</span>hasResults</span>
<span id="cb9-421"><a href="#cb9-421" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="vs">`</span><span class="sc">${</span>filteredOrganisations<span class="op">.</span><span class="at">length</span><span class="sc">}</span><span class="vs"> result</span><span class="sc">${</span>filteredOrganisations<span class="op">.</span><span class="at">length</span> <span class="op">!==</span> <span class="dv">1</span> <span class="op">?</span> <span class="st">'s'</span> <span class="op">:</span> <span class="st">''</span><span class="sc">}</span><span class="vs">`</span></span>
<span id="cb9-422"><a href="#cb9-422" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="st">'Select organisation'</span><span class="sc">}</span></span>
<span id="cb9-423"><a href="#cb9-423" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;/label&gt;</span></span>
<span id="cb9-424"><a href="#cb9-424" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;select class="nhstt-select" </span><span class="sc">${</span>isDisabled <span class="op">?</span> <span class="st">'disabled'</span> <span class="op">:</span> <span class="st">''</span><span class="sc">}</span><span class="vs">&gt;</span></span>
<span id="cb9-425"><a href="#cb9-425" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;option value=""&gt;</span></span>
<span id="cb9-426"><a href="#cb9-426" aria-hidden="true" tabindex="-1"></a><span class="vs">          </span><span class="sc">${</span>maxReached</span>
<span id="cb9-427"><a href="#cb9-427" aria-hidden="true" tabindex="-1"></a>            <span class="op">?</span> <span class="st">'-- Maximum 3 organisations selected --'</span></span>
<span id="cb9-428"><a href="#cb9-428" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> showPlaceholder</span>
<span id="cb9-429"><a href="#cb9-429" aria-hidden="true" tabindex="-1"></a>              <span class="op">?</span> <span class="st">'-- Enter at least 3 characters to search --'</span></span>
<span id="cb9-430"><a href="#cb9-430" aria-hidden="true" tabindex="-1"></a>              <span class="op">:</span> <span class="st">'-- No organisations found --'</span><span class="sc">}</span></span>
<span id="cb9-431"><a href="#cb9-431" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;/option&gt;</span></span>
<span id="cb9-432"><a href="#cb9-432" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;/select&gt;</span></span>
<span id="cb9-433"><a href="#cb9-433" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/div&gt;</span></span>
<span id="cb9-434"><a href="#cb9-434" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb9-435"><a href="#cb9-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-436"><a href="#cb9-436" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> select <span class="op">=</span> container<span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'select'</span>)<span class="op">;</span></span>
<span id="cb9-437"><a href="#cb9-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-438"><a href="#cb9-438" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (hasResults <span class="op">&amp;&amp;</span> <span class="op">!</span>maxReached) {</span>
<span id="cb9-439"><a href="#cb9-439" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Clear placeholder and add real options</span></span>
<span id="cb9-440"><a href="#cb9-440" aria-hidden="true" tabindex="-1"></a>    select<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">'&lt;option value=""&gt;-- Select an organisation --&lt;/option&gt;'</span><span class="op">;</span></span>
<span id="cb9-441"><a href="#cb9-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-442"><a href="#cb9-442" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Filter out already selected organisations</span></span>
<span id="cb9-443"><a href="#cb9-443" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> availableOrgs <span class="op">=</span> filteredOrganisations<span class="op">.</span><span class="fu">filter</span>(org <span class="kw">=&gt;</span></span>
<span id="cb9-444"><a href="#cb9-444" aria-hidden="true" tabindex="-1"></a>      <span class="op">!</span>selectedOrgs<span class="op">.</span><span class="fu">some</span>(selected <span class="kw">=&gt;</span> selected<span class="op">.</span><span class="at">org_code2</span> <span class="op">===</span> org<span class="op">.</span><span class="at">org_code2</span>)</span>
<span id="cb9-445"><a href="#cb9-445" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb9-446"><a href="#cb9-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-447"><a href="#cb9-447" aria-hidden="true" tabindex="-1"></a>    availableOrgs<span class="op">.</span><span class="fu">forEach</span>((org<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb9-448"><a href="#cb9-448" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> option <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'option'</span>)<span class="op">;</span></span>
<span id="cb9-449"><a href="#cb9-449" aria-hidden="true" tabindex="-1"></a>      option<span class="op">.</span><span class="at">value</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb9-450"><a href="#cb9-450" aria-hidden="true" tabindex="-1"></a>      option<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> org<span class="op">.</span><span class="at">org_name_code</span><span class="op">;</span></span>
<span id="cb9-451"><a href="#cb9-451" aria-hidden="true" tabindex="-1"></a>      select<span class="op">.</span><span class="fu">appendChild</span>(option)<span class="op">;</span></span>
<span id="cb9-452"><a href="#cb9-452" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb9-453"><a href="#cb9-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-454"><a href="#cb9-454" aria-hidden="true" tabindex="-1"></a>    select<span class="op">.</span><span class="at">_availableOrgs</span> <span class="op">=</span> availableOrgs<span class="op">;</span></span>
<span id="cb9-455"><a href="#cb9-455" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-456"><a href="#cb9-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-457"><a href="#cb9-457" aria-hidden="true" tabindex="-1"></a>  container<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb9-458"><a href="#cb9-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-459"><a href="#cb9-459" aria-hidden="true" tabindex="-1"></a>  select<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">'change'</span><span class="op">,</span> (e) <span class="kw">=&gt;</span> {</span>
<span id="cb9-460"><a href="#cb9-460" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> index <span class="op">=</span> <span class="pp">parseInt</span>(e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">value</span>)<span class="op">;</span></span>
<span id="cb9-461"><a href="#cb9-461" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span><span class="pp">isNaN</span>(index) <span class="op">&amp;&amp;</span> select<span class="op">.</span><span class="at">_availableOrgs</span>) {</span>
<span id="cb9-462"><a href="#cb9-462" aria-hidden="true" tabindex="-1"></a>      container<span class="op">.</span><span class="at">value</span> <span class="op">=</span> select<span class="op">.</span><span class="at">_availableOrgs</span>[index]<span class="op">;</span></span>
<span id="cb9-463"><a href="#cb9-463" aria-hidden="true" tabindex="-1"></a>      container<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(<span class="st">'input'</span>))<span class="op">;</span></span>
<span id="cb9-464"><a href="#cb9-464" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Reset dropdown after selection</span></span>
<span id="cb9-465"><a href="#cb9-465" aria-hidden="true" tabindex="-1"></a>      select<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb9-466"><a href="#cb9-466" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-467"><a href="#cb9-467" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb9-468"><a href="#cb9-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-469"><a href="#cb9-469" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> container<span class="op">;</span></span>
<span id="cb9-470"><a href="#cb9-470" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="select-organisation" class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="477" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 476;"><span id="cb10-477"><a href="#cb10-477" aria-hidden="true" tabindex="-1"></a><span class="co">// Add organisation to selected list when dropdown changes</span></span>
<span id="cb10-478"><a href="#cb10-478" aria-hidden="true" tabindex="-1"></a>addOrgEffect <span class="op">=</span> {</span>
<span id="cb10-479"><a href="#cb10-479" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (orgToAdd <span class="op">&amp;&amp;</span> selectedOrgs<span class="op">.</span><span class="at">length</span> <span class="op">&lt;</span> <span class="dv">3</span>) {</span>
<span id="cb10-480"><a href="#cb10-480" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Check if not already selected</span></span>
<span id="cb10-481"><a href="#cb10-481" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> alreadySelected <span class="op">=</span> selectedOrgs<span class="op">.</span><span class="fu">some</span>(org <span class="kw">=&gt;</span> org<span class="op">.</span><span class="at">org_code2</span> <span class="op">===</span> orgToAdd<span class="op">.</span><span class="at">org_code2</span>)<span class="op">;</span></span>
<span id="cb10-482"><a href="#cb10-482" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>alreadySelected) {</span>
<span id="cb10-483"><a href="#cb10-483" aria-hidden="true" tabindex="-1"></a>      mutable selectedOrgs <span class="op">=</span> [<span class="op">...</span>selectedOrgs<span class="op">,</span> orgToAdd]<span class="op">;</span></span>
<span id="cb10-484"><a href="#cb10-484" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-485"><a href="#cb10-485" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-486"><a href="#cb10-486" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb10-487"><a href="#cb10-487" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="add-organisation-effect" class="cell-output cell-output-display">
<div id="ojs-cell-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="494" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 493;"><span id="cb11-494"><a href="#cb11-494" aria-hidden="true" tabindex="-1"></a><span class="co">// Step 5: Update URL when selected orgs change</span></span>
<span id="cb11-495"><a href="#cb11-495" aria-hidden="true" tabindex="-1"></a>urlSyncEffect <span class="op">=</span> {</span>
<span id="cb11-496"><a href="#cb11-496" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> params <span class="op">=</span> <span class="kw">new</span> <span class="fu">URLSearchParams</span>(<span class="bu">window</span><span class="op">.</span><span class="at">location</span><span class="op">.</span><span class="at">search</span>)<span class="op">;</span></span>
<span id="cb11-497"><a href="#cb11-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-498"><a href="#cb11-498" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selectedOrgs<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span>) {</span>
<span id="cb11-499"><a href="#cb11-499" aria-hidden="true" tabindex="-1"></a>    params<span class="op">.</span><span class="fu">delete</span>(<span class="st">'orgs'</span>)<span class="op">;</span></span>
<span id="cb11-500"><a href="#cb11-500" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb11-501"><a href="#cb11-501" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> codes <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb11-502"><a href="#cb11-502" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> selectedOrgs<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb11-503"><a href="#cb11-503" aria-hidden="true" tabindex="-1"></a>      codes<span class="op">.</span><span class="fu">push</span>(selectedOrgs[i]<span class="op">.</span><span class="at">org_code2</span>)<span class="op">;</span></span>
<span id="cb11-504"><a href="#cb11-504" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-505"><a href="#cb11-505" aria-hidden="true" tabindex="-1"></a>    params<span class="op">.</span><span class="fu">set</span>(<span class="st">'orgs'</span><span class="op">,</span> codes<span class="op">.</span><span class="fu">join</span>(<span class="st">','</span>))<span class="op">;</span></span>
<span id="cb11-506"><a href="#cb11-506" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-507"><a href="#cb11-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-508"><a href="#cb11-508" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> newUrl <span class="op">=</span> params<span class="op">.</span><span class="fu">toString</span>()</span>
<span id="cb11-509"><a href="#cb11-509" aria-hidden="true" tabindex="-1"></a>    <span class="op">?</span> <span class="bu">window</span><span class="op">.</span><span class="at">location</span><span class="op">.</span><span class="at">pathname</span> <span class="op">+</span> <span class="st">'?'</span> <span class="op">+</span> params<span class="op">.</span><span class="fu">toString</span>()</span>
<span id="cb11-510"><a href="#cb11-510" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span> <span class="bu">window</span><span class="op">.</span><span class="at">location</span><span class="op">.</span><span class="at">pathname</span><span class="op">;</span></span>
<span id="cb11-511"><a href="#cb11-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-512"><a href="#cb11-512" aria-hidden="true" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="at">history</span><span class="op">.</span><span class="fu">replaceState</span>({}<span class="op">,</span> <span class="st">''</span><span class="op">,</span> newUrl)<span class="op">;</span></span>
<span id="cb11-513"><a href="#cb11-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-514"><a href="#cb11-514" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb11-515"><a href="#cb11-515" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="sync-url" class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="522" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 521;"><span id="cb12-522"><a href="#cb12-522" aria-hidden="true" tabindex="-1"></a>selectedOrgDisplay <span class="op">=</span> {</span>
<span id="cb12-523"><a href="#cb12-523" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> container <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="nhstt-container"&gt;&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb12-524"><a href="#cb12-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-525"><a href="#cb12-525" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selectedOrgs<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span>) {</span>
<span id="cb12-526"><a href="#cb12-526" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb12-527"><a href="#cb12-527" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;div class="nhstt-result-box"&gt;</span></span>
<span id="cb12-528"><a href="#cb12-528" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;div class="nhstt-result-title"&gt;Selected Organisations (0 of 3)&lt;/div&gt;</span></span>
<span id="cb12-529"><a href="#cb12-529" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;p class="nhstt-result-empty"&gt;No organisations selected. You can select up to 3 organisations.&lt;/p&gt;</span></span>
<span id="cb12-530"><a href="#cb12-530" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;/div&gt;</span></span>
<span id="cb12-531"><a href="#cb12-531" aria-hidden="true" tabindex="-1"></a><span class="vs">    `</span><span class="op">;</span></span>
<span id="cb12-532"><a href="#cb12-532" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb12-533"><a href="#cb12-533" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> resultBox <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb12-534"><a href="#cb12-534" aria-hidden="true" tabindex="-1"></a>    resultBox<span class="op">.</span><span class="at">className</span> <span class="op">=</span> <span class="st">'nhstt-result-box'</span><span class="op">;</span></span>
<span id="cb12-535"><a href="#cb12-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-536"><a href="#cb12-536" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> title <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb12-537"><a href="#cb12-537" aria-hidden="true" tabindex="-1"></a>    title<span class="op">.</span><span class="at">className</span> <span class="op">=</span> <span class="st">'nhstt-result-title'</span><span class="op">;</span></span>
<span id="cb12-538"><a href="#cb12-538" aria-hidden="true" tabindex="-1"></a>    title<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="vs">`Selected Organisation</span><span class="sc">${</span>selectedOrgs<span class="op">.</span><span class="at">length</span> <span class="op">!==</span> <span class="dv">1</span> <span class="op">?</span> <span class="st">'s'</span> <span class="op">:</span> <span class="st">''</span><span class="sc">}</span><span class="vs"> (</span><span class="sc">${</span>selectedOrgs<span class="op">.</span><span class="at">length</span><span class="sc">}</span><span class="vs"> of 3)`</span><span class="op">;</span></span>
<span id="cb12-539"><a href="#cb12-539" aria-hidden="true" tabindex="-1"></a>    resultBox<span class="op">.</span><span class="fu">appendChild</span>(title)<span class="op">;</span></span>
<span id="cb12-540"><a href="#cb12-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-541"><a href="#cb12-541" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> chipContainer <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb12-542"><a href="#cb12-542" aria-hidden="true" tabindex="-1"></a>    chipContainer<span class="op">.</span><span class="at">className</span> <span class="op">=</span> <span class="st">'nhstt-chip-container'</span><span class="op">;</span></span>
<span id="cb12-543"><a href="#cb12-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-544"><a href="#cb12-544" aria-hidden="true" tabindex="-1"></a>    selectedOrgs<span class="op">.</span><span class="fu">forEach</span>(org <span class="kw">=&gt;</span> {</span>
<span id="cb12-545"><a href="#cb12-545" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> chip <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb12-546"><a href="#cb12-546" aria-hidden="true" tabindex="-1"></a>      chip<span class="op">.</span><span class="at">className</span> <span class="op">=</span> <span class="st">'nhstt-chip'</span><span class="op">;</span></span>
<span id="cb12-547"><a href="#cb12-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-548"><a href="#cb12-548" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> label <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'span'</span>)<span class="op">;</span></span>
<span id="cb12-549"><a href="#cb12-549" aria-hidden="true" tabindex="-1"></a>      label<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> org<span class="op">.</span><span class="at">org_name_code</span><span class="op">;</span></span>
<span id="cb12-550"><a href="#cb12-550" aria-hidden="true" tabindex="-1"></a>      chip<span class="op">.</span><span class="fu">appendChild</span>(label)<span class="op">;</span></span>
<span id="cb12-551"><a href="#cb12-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-552"><a href="#cb12-552" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> removeBtn <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'button'</span>)<span class="op">;</span></span>
<span id="cb12-553"><a href="#cb12-553" aria-hidden="true" tabindex="-1"></a>      removeBtn<span class="op">.</span><span class="at">className</span> <span class="op">=</span> <span class="st">'nhstt-chip-remove'</span><span class="op">;</span></span>
<span id="cb12-554"><a href="#cb12-554" aria-hidden="true" tabindex="-1"></a>      removeBtn<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">'Ã—'</span><span class="op">;</span></span>
<span id="cb12-555"><a href="#cb12-555" aria-hidden="true" tabindex="-1"></a>      removeBtn<span class="op">.</span><span class="at">title</span> <span class="op">=</span> <span class="st">'Remove'</span><span class="op">;</span></span>
<span id="cb12-556"><a href="#cb12-556" aria-hidden="true" tabindex="-1"></a>      removeBtn<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb12-557"><a href="#cb12-557" aria-hidden="true" tabindex="-1"></a>        mutable selectedOrgs <span class="op">=</span> selectedOrgs<span class="op">.</span><span class="fu">filter</span>(o <span class="kw">=&gt;</span> o<span class="op">.</span><span class="at">org_code2</span> <span class="op">!==</span> org<span class="op">.</span><span class="at">org_code2</span>)<span class="op">;</span></span>
<span id="cb12-558"><a href="#cb12-558" aria-hidden="true" tabindex="-1"></a>      }<span class="op">;</span></span>
<span id="cb12-559"><a href="#cb12-559" aria-hidden="true" tabindex="-1"></a>      chip<span class="op">.</span><span class="fu">appendChild</span>(removeBtn)<span class="op">;</span></span>
<span id="cb12-560"><a href="#cb12-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-561"><a href="#cb12-561" aria-hidden="true" tabindex="-1"></a>      chipContainer<span class="op">.</span><span class="fu">appendChild</span>(chip)<span class="op">;</span></span>
<span id="cb12-562"><a href="#cb12-562" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb12-563"><a href="#cb12-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-564"><a href="#cb12-564" aria-hidden="true" tabindex="-1"></a>    resultBox<span class="op">.</span><span class="fu">appendChild</span>(chipContainer)<span class="op">;</span></span>
<span id="cb12-565"><a href="#cb12-565" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="fu">appendChild</span>(resultBox)<span class="op">;</span></span>
<span id="cb12-566"><a href="#cb12-566" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-567"><a href="#cb12-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-568"><a href="#cb12-568" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> container<span class="op">;</span></span>
<span id="cb12-569"><a href="#cb12-569" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="display-selected" class="cell-output cell-output-display">
<div id="ojs-cell-12" data-nodetype="declaration">

</div>
</div>
</div>
</section><script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuLy8gQ29udmVydCBSIGRhdGEgdG8gSmF2YVNjcmlwdCBhcnJheSBvZiBvYmplY3RzXG5vcmdhbmlzYXRpb25zID0gdHJhbnNwb3NlKG9yZ19saXN0X29qcylcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuLy8gU3RlcCAxOiBKdXN0IHJlYWQgVVJMIHBhcmFtZXRlclxudXJsT3Jnc1BhcmFtID0ge1xuICBjb25zdCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xuICByZXR1cm4gcGFyYW1zLmdldCgnb3JncycpIHx8ICcnO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG4vLyBTdGVwIDI6IFBhcnNlIFVSTCBwYXJhbWV0ZXIgaW50byBhcnJheSBvZiBjb2Rlc1xudXJsT3JnQ29kZXMgPSB7XG4gIGlmICghdXJsT3Jnc1BhcmFtKSByZXR1cm4gW107XG5cbiAgY29uc3QgY29kZXMgPSB1cmxPcmdzUGFyYW0uc3BsaXQoJywnKTtcbiAgY29uc3QgdHJpbW1lZCA9IFtdO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY29kZXMubGVuZ3RoICYmIGkgPCAzOyBpKyspIHtcbiAgICBjb25zdCBjb2RlID0gY29kZXNbaV0udHJpbSgpO1xuICAgIGlmIChjb2RlLmxlbmd0aCA+IDApIHtcbiAgICAgIHRyaW1tZWQucHVzaChjb2RlKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdHJpbW1lZDtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuLy8gU3RlcCAzOiBWYWxpZGF0ZSBjb2RlcyBhbmQgY29udmVydCB0byBvcmcgb2JqZWN0c1xuaW5pdGlhbFNlbGVjdGVkT3JncyA9IHtcbiAgY29uc3QgcmVzb2x2ZWQgPSBbXTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IHVybE9yZ0NvZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgY29kZSA9IHVybE9yZ0NvZGVzW2ldO1xuXG4gICAgLy8gRmluZCBvcmcgd2l0aCB0aGlzIGNvZGVcbiAgICBsZXQgZm91bmQgPSBudWxsO1xuICAgIGZvciAobGV0IGogPSAwOyBqIDwgb3JnYW5pc2F0aW9ucy5sZW5ndGg7IGorKykge1xuICAgICAgaWYgKG9yZ2FuaXNhdGlvbnNbal0ub3JnX2NvZGUyID09PSBjb2RlKSB7XG4gICAgICAgIGZvdW5kID0gb3JnYW5pc2F0aW9uc1tqXTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQWRkIGlmIHZhbGlkIGFuZCBub3QgZHVwbGljYXRlXG4gICAgaWYgKGZvdW5kKSB7XG4gICAgICBsZXQgaXNEdXBsaWNhdGUgPSBmYWxzZTtcbiAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgcmVzb2x2ZWQubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgaWYgKHJlc29sdmVkW2tdLm9yZ19jb2RlMiA9PT0gY29kZSkge1xuICAgICAgICAgIGlzRHVwbGljYXRlID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoIWlzRHVwbGljYXRlKSB7XG4gICAgICAgIHJlc29sdmVkLnB1c2goZm91bmQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiByZXNvbHZlZDtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuLy8gUHJvZmVzc2lvbmFsIFVJIHN0eWxpbmdcbnN0eWxlcyA9IGh0bWxgPHN0eWxlPlxuICAubmhzdHQtY29udGFpbmVyIHtcbiAgICBtYXgtd2lkdGg6IDgwMHB4O1xuICAgIG1hcmdpbjogMCBhdXRvO1xuICAgIHBhZGRpbmc6IDAgNHB4O1xuICB9XG5cbiAgLm5oc3R0LWlucHV0LWdyb3VwIHtcbiAgICBtYXJnaW4tYm90dG9tOiAyMHB4O1xuICB9XG5cbiAgLm5oc3R0LWxhYmVsIHtcbiAgICBkaXNwbGF5OiBibG9jaztcbiAgICBmb250LXdlaWdodDogNjAwO1xuICAgIGZvbnQtc2l6ZTogMTRweDtcbiAgICBtYXJnaW4tYm90dG9tOiA2cHg7XG4gICAgY29sb3I6ICMyMTI1Mjk7XG4gIH1cblxuICAubmhzdHQtaW5wdXQge1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIHBhZGRpbmc6IDEwcHggMTJweDtcbiAgICBmb250LXNpemU6IDE0cHg7XG4gICAgYm9yZGVyOiAxcHggc29saWQgI2RlZTJlNjtcbiAgICBib3JkZXItcmFkaXVzOiAwLjM3NXJlbTtcbiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICB9XG5cbiAgLm5oc3R0LWlucHV0OmZvY3VzIHtcbiAgICBvdXRsaW5lOiBub25lO1xuICAgIGJvcmRlci1jb2xvcjogIzg2YjdmZTtcbiAgICBib3gtc2hhZG93OiAwIDAgMCAwLjI1cmVtIHJnYmEoMTMsIDExMCwgMjUzLCAwLjI1KTtcbiAgfVxuXG4gIC5uaHN0dC1zZWxlY3Qge1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIHBhZGRpbmc6IDEwcHggMTJweDtcbiAgICBmb250LXNpemU6IDE0cHg7XG4gICAgYm9yZGVyOiAxcHggc29saWQgI2RlZTJlNjtcbiAgICBib3JkZXItcmFkaXVzOiAwLjM3NXJlbTtcbiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAgIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xuICB9XG5cbiAgLm5oc3R0LXNlbGVjdDpkaXNhYmxlZCB7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2U5ZWNlZjtcbiAgICBjb2xvcjogIzZjNzU3ZDtcbiAgICBjdXJzb3I6IG5vdC1hbGxvd2VkO1xuICB9XG5cbiAgLm5oc3R0LWhlbHBlci10ZXh0IHtcbiAgICBmb250LXNpemU6IDEycHg7XG4gICAgY29sb3I6ICM2Yzc1N2Q7XG4gICAgbWFyZ2luLXRvcDogNHB4O1xuICAgIGZvbnQtc3R5bGU6IGl0YWxpYztcbiAgfVxuXG4gIC5uaHN0dC1yZXN1bHQtYm94IHtcbiAgICBtYXJnaW4tdG9wOiAyMHB4O1xuICAgIHBhZGRpbmc6IDE2cHg7XG4gICAgYm9yZGVyOiAxcHggc29saWQgI2RlZTJlNjtcbiAgICBib3JkZXItcmFkaXVzOiAwLjM3NXJlbTtcbiAgICBiYWNrZ3JvdW5kOiB3aGl0ZTtcbiAgICBtaW4taGVpZ2h0OiAxMjBweDtcbiAgfVxuXG4gIC5uaHN0dC1yZXN1bHQtdGl0bGUge1xuICAgIGZvbnQtd2VpZ2h0OiA2MDA7XG4gICAgZm9udC1zaXplOiAxNHB4O1xuICAgIG1hcmdpbjogMCAwIDEycHggMDtcbiAgICBjb2xvcjogIzQ5NTA1NztcbiAgfVxuXG4gIC5uaHN0dC1yZXN1bHQtY29udGVudCB7XG4gICAgbWFyZ2luOiAwO1xuICAgIGZvbnQtc2l6ZTogMTRweDtcbiAgICBjb2xvcjogIzIxMjUyOTtcbiAgfVxuXG4gIC5uaHN0dC1yZXN1bHQtZW1wdHkge1xuICAgIG1hcmdpbjogMDtcbiAgICBmb250LXNpemU6IDE0cHg7XG4gICAgY29sb3I6ICM2Yzc1N2Q7XG4gIH1cblxuICAubmhzdHQtY2hpcC1jb250YWluZXIge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC13cmFwOiB3cmFwO1xuICAgIGdhcDogNnB4O1xuICAgIG1pbi1oZWlnaHQ6IDI4cHg7XG4gIH1cblxuICAubmhzdHQtY2hpcCB7XG4gICAgZGlzcGxheTogaW5saW5lLWZsZXg7XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICBnYXA6IDZweDtcbiAgICBwYWRkaW5nOiA0cHggMTBweDtcbiAgICBiYWNrZ3JvdW5kOiAjZjhmOWZhO1xuICAgIGJvcmRlcjogMXB4IHNvbGlkICNkZWUyZTY7XG4gICAgYm9yZGVyLXJhZGl1czogMC4yNXJlbTtcbiAgICBmb250LXNpemU6IDEzcHg7XG4gICAgY29sb3I6ICMyMTI1Mjk7XG4gIH1cblxuICAubmhzdHQtY2hpcC1yZW1vdmUge1xuICAgIGJhY2tncm91bmQ6IG5vbmU7XG4gICAgYm9yZGVyOiBub25lO1xuICAgIGNvbG9yOiAjYWRiNWJkO1xuICAgIGZvbnQtc2l6ZTogMThweDtcbiAgICBsaW5lLWhlaWdodDogMTtcbiAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgcGFkZGluZzogMDtcbiAgICBtYXJnaW4tbGVmdDogNHB4O1xuICAgIHdpZHRoOiAxNnB4O1xuICAgIGhlaWdodDogMTZweDtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgdHJhbnNpdGlvbjogY29sb3IgMC4xNXM7XG4gIH1cblxuICAubmhzdHQtY2hpcC1yZW1vdmU6aG92ZXIge1xuICAgIGNvbG9yOiAjNmM3NTdkO1xuICB9XG5cbiAgLm5oc3R0LXNlbGVjdGlvbi1pbmZvIHtcbiAgICBmb250LXNpemU6IDEycHg7XG4gICAgY29sb3I6ICM2Yzc1N2Q7XG4gICAgbWFyZ2luLXRvcDogOHB4O1xuICAgIGZvbnQtd2VpZ2h0OiA2MDA7XG4gIH1cbjwvc3R5bGU+YFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG52aWV3b2Ygc2VhcmNoUXVlcnkgPSB7XG4gIGNvbnN0IGNvbnRhaW5lciA9IGh0bWxgPGRpdiBjbGFzcz1cIm5oc3R0LWNvbnRhaW5lclwiPlxuICAgIDxkaXYgY2xhc3M9XCJuaHN0dC1pbnB1dC1ncm91cFwiPlxuICAgICAgPGxhYmVsIGNsYXNzPVwibmhzdHQtbGFiZWxcIj5TZWFyY2ggTkhTIFRhbGtpbmcgVGhlcmFwaWVzIHByb3ZpZGVyPC9sYWJlbD5cbiAgICAgIDxpbnB1dFxuICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgIGNsYXNzPVwibmhzdHQtaW5wdXRcIlxuICAgICAgICBwbGFjZWhvbGRlcj1cIkVudGVyIGF0IGxlYXN0IDMgY2hhcmFjdGVycyB0byBzZWFyY2guLi5cIlxuICAgICAgICB2YWx1ZT1cIlwiXG4gICAgICAvPlxuICAgICAgPGRpdiBjbGFzcz1cIm5oc3R0LWhlbHBlci10ZXh0XCI+U2VhcmNoIGJ5IG9yZ2FuaXNhdGlvbiBuYW1lIG9yIGNvZGU8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+YDtcblxuICBjb25zdCBpbnB1dCA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpO1xuICBjb250YWluZXIudmFsdWUgPSBcIlwiO1xuXG4gIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKGUpID0+IHtcbiAgICBjb250YWluZXIudmFsdWUgPSBlLnRhcmdldC52YWx1ZTtcbiAgICBjb250YWluZXIuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2lucHV0JykpO1xuICB9KTtcblxuICByZXR1cm4gY29udGFpbmVyO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG4vLyBGaWx0ZXIgb3JnYW5pc2F0aW9ucyBiYXNlZCBvbiBzZWFyY2ggcXVlcnlcbmZpbHRlcmVkT3JnYW5pc2F0aW9ucyA9IHtcbiAgaWYgKCFzZWFyY2hRdWVyeSB8fCBzZWFyY2hRdWVyeS5sZW5ndGggPCAzKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgY29uc3QgbG93ZXJRdWVyeSA9IHNlYXJjaFF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG5cbiAgcmV0dXJuIG9yZ2FuaXNhdGlvbnMuZmlsdGVyKG9yZyA9PiB7XG4gICAgY29uc3QgbmFtZUNvZGVNYXRjaCA9IG9yZy5vcmdfbmFtZV9jb2RlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobG93ZXJRdWVyeSk7XG4gICAgcmV0dXJuIG5hbWVDb2RlTWF0Y2g7XG4gIH0pO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG4vLyBNdXRhYmxlIHN0YXRlIGZvciBzZWxlY3RlZCBvcmdhbmlzYXRpb25zIChtYXggMylcbi8vIFN0ZXAgNDogSW5pdGlhbGl6ZSBmcm9tIFVSTFxubXV0YWJsZSBzZWxlY3RlZE9yZ3MgPSBpbml0aWFsU2VsZWN0ZWRPcmdzXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcbnZpZXdvZiBvcmdUb0FkZCA9IHtcbiAgY29uc3QgaGFzUmVzdWx0cyA9IGZpbHRlcmVkT3JnYW5pc2F0aW9ucy5sZW5ndGggPiAwO1xuICBjb25zdCBzaG93UGxhY2Vob2xkZXIgPSAhc2VhcmNoUXVlcnkgfHwgc2VhcmNoUXVlcnkubGVuZ3RoIDwgMztcbiAgY29uc3QgbWF4UmVhY2hlZCA9IHNlbGVjdGVkT3Jncy5sZW5ndGggPj0gMztcbiAgY29uc3QgaXNEaXNhYmxlZCA9ICFoYXNSZXN1bHRzIHx8IG1heFJlYWNoZWQ7XG5cbiAgY29uc3QgY29udGFpbmVyID0gaHRtbGA8ZGl2IGNsYXNzPVwibmhzdHQtY29udGFpbmVyXCI+XG4gICAgPGRpdiBjbGFzcz1cIm5oc3R0LWlucHV0LWdyb3VwXCI+XG4gICAgICA8bGFiZWwgY2xhc3M9XCJuaHN0dC1sYWJlbFwiPlxuICAgICAgICAke2hhc1Jlc3VsdHNcbiAgICAgICAgICA/IGAke2ZpbHRlcmVkT3JnYW5pc2F0aW9ucy5sZW5ndGh9IHJlc3VsdCR7ZmlsdGVyZWRPcmdhbmlzYXRpb25zLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfWBcbiAgICAgICAgICA6ICdTZWxlY3Qgb3JnYW5pc2F0aW9uJ31cbiAgICAgIDwvbGFiZWw+XG4gICAgICA8c2VsZWN0IGNsYXNzPVwibmhzdHQtc2VsZWN0XCIgJHtpc0Rpc2FibGVkID8gJ2Rpc2FibGVkJyA6ICcnfT5cbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIlwiPlxuICAgICAgICAgICR7bWF4UmVhY2hlZFxuICAgICAgICAgICAgPyAnLS0gTWF4aW11bSAzIG9yZ2FuaXNhdGlvbnMgc2VsZWN0ZWQgLS0nXG4gICAgICAgICAgICA6IHNob3dQbGFjZWhvbGRlclxuICAgICAgICAgICAgICA/ICctLSBFbnRlciBhdCBsZWFzdCAzIGNoYXJhY3RlcnMgdG8gc2VhcmNoIC0tJ1xuICAgICAgICAgICAgICA6ICctLSBObyBvcmdhbmlzYXRpb25zIGZvdW5kIC0tJ31cbiAgICAgICAgPC9vcHRpb24+XG4gICAgICA8L3NlbGVjdD5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+YDtcblxuICBjb25zdCBzZWxlY3QgPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcignc2VsZWN0Jyk7XG5cbiAgaWYgKGhhc1Jlc3VsdHMgJiYgIW1heFJlYWNoZWQpIHtcbiAgICAvLyBDbGVhciBwbGFjZWhvbGRlciBhbmQgYWRkIHJlYWwgb3B0aW9uc1xuICAgIHNlbGVjdC5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT1cIlwiPi0tIFNlbGVjdCBhbiBvcmdhbmlzYXRpb24gLS08L29wdGlvbj4nO1xuXG4gICAgLy8gRmlsdGVyIG91dCBhbHJlYWR5IHNlbGVjdGVkIG9yZ2FuaXNhdGlvbnNcbiAgICBjb25zdCBhdmFpbGFibGVPcmdzID0gZmlsdGVyZWRPcmdhbmlzYXRpb25zLmZpbHRlcihvcmcgPT5cbiAgICAgICFzZWxlY3RlZE9yZ3Muc29tZShzZWxlY3RlZCA9PiBzZWxlY3RlZC5vcmdfY29kZTIgPT09IG9yZy5vcmdfY29kZTIpXG4gICAgKTtcblxuICAgIGF2YWlsYWJsZU9yZ3MuZm9yRWFjaCgob3JnLCBpKSA9PiB7XG4gICAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAgIG9wdGlvbi52YWx1ZSA9IGk7XG4gICAgICBvcHRpb24udGV4dENvbnRlbnQgPSBvcmcub3JnX25hbWVfY29kZTtcbiAgICAgIHNlbGVjdC5hcHBlbmRDaGlsZChvcHRpb24pO1xuICAgIH0pO1xuXG4gICAgc2VsZWN0Ll9hdmFpbGFibGVPcmdzID0gYXZhaWxhYmxlT3JncztcbiAgfVxuXG4gIGNvbnRhaW5lci52YWx1ZSA9IG51bGw7XG5cbiAgc2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7XG4gICAgY29uc3QgaW5kZXggPSBwYXJzZUludChlLnRhcmdldC52YWx1ZSk7XG4gICAgaWYgKCFpc05hTihpbmRleCkgJiYgc2VsZWN0Ll9hdmFpbGFibGVPcmdzKSB7XG4gICAgICBjb250YWluZXIudmFsdWUgPSBzZWxlY3QuX2F2YWlsYWJsZU9yZ3NbaW5kZXhdO1xuICAgICAgY29udGFpbmVyLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdpbnB1dCcpKTtcbiAgICAgIC8vIFJlc2V0IGRyb3Bkb3duIGFmdGVyIHNlbGVjdGlvblxuICAgICAgc2VsZWN0LnZhbHVlID0gXCJcIjtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBjb250YWluZXI7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG4vLyBBZGQgb3JnYW5pc2F0aW9uIHRvIHNlbGVjdGVkIGxpc3Qgd2hlbiBkcm9wZG93biBjaGFuZ2VzXG5hZGRPcmdFZmZlY3QgPSB7XG4gIGlmIChvcmdUb0FkZCAmJiBzZWxlY3RlZE9yZ3MubGVuZ3RoIDwgMykge1xuICAgIC8vIENoZWNrIGlmIG5vdCBhbHJlYWR5IHNlbGVjdGVkXG4gICAgY29uc3QgYWxyZWFkeVNlbGVjdGVkID0gc2VsZWN0ZWRPcmdzLnNvbWUob3JnID0+IG9yZy5vcmdfY29kZTIgPT09IG9yZ1RvQWRkLm9yZ19jb2RlMik7XG4gICAgaWYgKCFhbHJlYWR5U2VsZWN0ZWQpIHtcbiAgICAgIG11dGFibGUgc2VsZWN0ZWRPcmdzID0gWy4uLnNlbGVjdGVkT3Jncywgb3JnVG9BZGRdO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcbi8vIFN0ZXAgNTogVXBkYXRlIFVSTCB3aGVuIHNlbGVjdGVkIG9yZ3MgY2hhbmdlXG51cmxTeW5jRWZmZWN0ID0ge1xuICBjb25zdCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xuXG4gIGlmIChzZWxlY3RlZE9yZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgcGFyYW1zLmRlbGV0ZSgnb3JncycpO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGNvZGVzID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3RlZE9yZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvZGVzLnB1c2goc2VsZWN0ZWRPcmdzW2ldLm9yZ19jb2RlMik7XG4gICAgfVxuICAgIHBhcmFtcy5zZXQoJ29yZ3MnLCBjb2Rlcy5qb2luKCcsJykpO1xuICB9XG5cbiAgY29uc3QgbmV3VXJsID0gcGFyYW1zLnRvU3RyaW5nKClcbiAgICA/IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSArICc/JyArIHBhcmFtcy50b1N0cmluZygpXG4gICAgOiB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7XG5cbiAgd2luZG93Lmhpc3RvcnkucmVwbGFjZVN0YXRlKHt9LCAnJywgbmV3VXJsKTtcblxuICByZXR1cm4gbnVsbDtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcbnNlbGVjdGVkT3JnRGlzcGxheSA9IHtcbiAgY29uc3QgY29udGFpbmVyID0gaHRtbGA8ZGl2IGNsYXNzPVwibmhzdHQtY29udGFpbmVyXCI+PC9kaXY+YDtcblxuICBpZiAoc2VsZWN0ZWRPcmdzLmxlbmd0aCA9PT0gMCkge1xuICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBgXG4gICAgICA8ZGl2IGNsYXNzPVwibmhzdHQtcmVzdWx0LWJveFwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwibmhzdHQtcmVzdWx0LXRpdGxlXCI+U2VsZWN0ZWQgT3JnYW5pc2F0aW9ucyAoMCBvZiAzKTwvZGl2PlxuICAgICAgICA8cCBjbGFzcz1cIm5oc3R0LXJlc3VsdC1lbXB0eVwiPk5vIG9yZ2FuaXNhdGlvbnMgc2VsZWN0ZWQuIFlvdSBjYW4gc2VsZWN0IHVwIHRvIDMgb3JnYW5pc2F0aW9ucy48L3A+XG4gICAgICA8L2Rpdj5cbiAgICBgO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHJlc3VsdEJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHJlc3VsdEJveC5jbGFzc05hbWUgPSAnbmhzdHQtcmVzdWx0LWJveCc7XG5cbiAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRpdGxlLmNsYXNzTmFtZSA9ICduaHN0dC1yZXN1bHQtdGl0bGUnO1xuICAgIHRpdGxlLnRleHRDb250ZW50ID0gYFNlbGVjdGVkIE9yZ2FuaXNhdGlvbiR7c2VsZWN0ZWRPcmdzLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfSAoJHtzZWxlY3RlZE9yZ3MubGVuZ3RofSBvZiAzKWA7XG4gICAgcmVzdWx0Qm94LmFwcGVuZENoaWxkKHRpdGxlKTtcblxuICAgIGNvbnN0IGNoaXBDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjaGlwQ29udGFpbmVyLmNsYXNzTmFtZSA9ICduaHN0dC1jaGlwLWNvbnRhaW5lcic7XG5cbiAgICBzZWxlY3RlZE9yZ3MuZm9yRWFjaChvcmcgPT4ge1xuICAgICAgY29uc3QgY2hpcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgY2hpcC5jbGFzc05hbWUgPSAnbmhzdHQtY2hpcCc7XG5cbiAgICAgIGNvbnN0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgbGFiZWwudGV4dENvbnRlbnQgPSBvcmcub3JnX25hbWVfY29kZTtcbiAgICAgIGNoaXAuYXBwZW5kQ2hpbGQobGFiZWwpO1xuXG4gICAgICBjb25zdCByZW1vdmVCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgIHJlbW92ZUJ0bi5jbGFzc05hbWUgPSAnbmhzdHQtY2hpcC1yZW1vdmUnO1xuICAgICAgcmVtb3ZlQnRuLmlubmVySFRNTCA9ICfDlyc7XG4gICAgICByZW1vdmVCdG4udGl0bGUgPSAnUmVtb3ZlJztcbiAgICAgIHJlbW92ZUJ0bi5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICBtdXRhYmxlIHNlbGVjdGVkT3JncyA9IHNlbGVjdGVkT3Jncy5maWx0ZXIobyA9PiBvLm9yZ19jb2RlMiAhPT0gb3JnLm9yZ19jb2RlMik7XG4gICAgICB9O1xuICAgICAgY2hpcC5hcHBlbmRDaGlsZChyZW1vdmVCdG4pO1xuXG4gICAgICBjaGlwQ29udGFpbmVyLmFwcGVuZENoaWxkKGNoaXApO1xuICAgIH0pO1xuXG4gICAgcmVzdWx0Qm94LmFwcGVuZENoaWxkKGNoaXBDb250YWluZXIpO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChyZXN1bHRCb3gpO1xuICB9XG5cbiAgcmV0dXJuIGNvbnRhaW5lcjtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc2VhcmNoUXVlcnknKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnb3JnVG9BZGQnKSJ9XX0=
</script><script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../..";
window._ojs.paths.runtimeToRoot = "../../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Milan Wiedemann, Wellcome Trust.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
